---
description: –ü—Ä–∞–≤–∏–ª–∞ React –∏ Next.js. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º –∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º.
globs: ["**/*.tsx", "**/app/**", "**/components/**", "**/features/**"]
alwaysApply: false
---

# –ü–†–ê–í–ò–õ–ê REACT –ò NEXT.JS

> –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π React —Å Server Components, App Router –∏ –ª—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏.

---

## üéØ –ì–õ–ê–í–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´

1. **Server Components –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** ‚Äî 'use client' —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
2. **–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –≤–∞–∂–Ω–µ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è** ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
3. **Colocation** ‚Äî —Å–≤—è–∑–∞–Ω–Ω—ã–π –∫–æ–¥ —Ä—è–¥–æ–º
4. **–ú–∏–Ω–∏–º—É–º —Å–æ—Å—Ç–æ—è–Ω–∏—è** ‚Äî derive –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–æ

---

## üì¶ –°–¢–†–£–ö–¢–£–†–ê –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

### –®–∞–±–ª–æ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

```tsx
// 1. Imports ‚Äî —Å–Ω–∞—á–∞–ª–∞ React/Next, –ø–æ—Ç–æ–º –≤–Ω–µ—à–Ω–∏–µ, –ø–æ—Ç–æ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ
import { useState, useCallback, memo } from 'react';
import { useRouter } from 'next/navigation';
import { clsx } from 'clsx';

import { Button } from '@/shared/components/ui';
import { useUser } from '@/features/auth';
import type { Product } from './types';

// 2. Types
interface ProductCardProps {
  product: Product;
  onAddToCart: (productId: string) => void;
  variant?: 'compact' | 'full';
  className?: string;
}

// 3. Component
export function ProductCard({
  product,
  onAddToCart,
  variant = 'full',
  className,
}: ProductCardProps) {
  // 4. Hooks
  const [quantity, setQuantity] = useState(1);
  const router = useRouter();
  
  // 5. Derived state
  const isOutOfStock = product.stock === 0;
  const totalPrice = product.price * quantity;
  
  // 6. Callbacks
  const handleAddToCart = useCallback(() => {
    onAddToCart(product.id);
  }, [product.id, onAddToCart]);
  
  // 7. Early returns
  if (!product.isActive) {
    return null;
  }
  
  // 8. Render
  return (
    <article className={clsx('rounded-lg p-4', className)}>
      <img 
        src={product.image} 
        alt={product.name}
        className="w-full aspect-square object-cover"
      />
      <h3 className="mt-4 text-lg font-semibold">
        {product.name}
      </h3>
      <p className="text-2xl font-bold text-primary">
        {formatPrice(totalPrice)}
      </p>
      <Button 
        onClick={handleAddToCart}
        disabled={isOutOfStock}
        className="mt-4 w-full"
      >
        {isOutOfStock ? '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : '–í –∫–æ—Ä–∑–∏–Ω—É'}
      </Button>
    </article>
  );
}
```

### –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã (–≤—Å–µ–≥–¥–∞)

```tsx
// ‚úÖ –•–û–†–û–®–û ‚Äî –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
export function ProductCard() { ... }
export function ProductList() { ... }

// ‚ùå –ü–õ–û–•–û ‚Äî default export
export default function ProductCard() { ... }
```

---

## üåê NEXT.JS APP ROUTER

### Server Components (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```tsx
// app/products/page.tsx ‚Äî Server Component
import { ProductList } from '@/features/products';
import { getProducts } from '@/lib/api';

// Async –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
export default async function ProductsPage() {
  const products = await getProducts();
  
  return (
    <main className="container py-8">
      <h1 className="text-3xl font-bold mb-8">–ö–∞—Ç–∞–ª–æ–≥</h1>
      <ProductList products={products} />
    </main>
  );
}
```

### Client Components (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)

```tsx
// features/products/components/ProductFilters.tsx
'use client';

import { useState } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';

export function ProductFilters() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const [category, setCategory] = useState(searchParams.get('category') ?? '');
  
  const handleFilter = () => {
    const params = new URLSearchParams(searchParams);
    params.set('category', category);
    router.push(`?${params.toString()}`);
  };
  
  return (
    <div className="flex gap-4">
      <select 
        value={category} 
        onChange={(e) => setCategory(e.target.value)}
      >
        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
        <option value="electronics">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</option>
      </select>
      <button onClick={handleFilter}>–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    </div>
  );
}
```

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 'use client'

```tsx
// ‚úÖ –ù—É–∂–µ–Ω 'use client':
// - useState, useEffect, useContext
// - Event handlers (onClick, onChange)
// - Browser APIs (localStorage, window)
// - –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
// - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞

// ‚ùå –ù–ï –Ω—É–∂–µ–Ω 'use client':
// - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
// - Fetch –¥–∞–Ω–Ω—ã—Ö
// - –î–æ—Å—Ç—É–ø –∫ –ë–î –Ω–∞–ø—Ä—è–º—É—é
// - –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
```

### Server Actions

```tsx
// app/actions/products.ts
'use server';

import { revalidatePath } from 'next/cache';
import { db } from '@/lib/db';

export async function createProduct(formData: FormData) {
  const name = formData.get('name') as string;
  const price = Number(formData.get('price'));
  
  await db.product.create({
    data: { name, price },
  });
  
  revalidatePath('/products');
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
// app/products/new/page.tsx
import { createProduct } from '../actions/products';

export default function NewProductPage() {
  return (
    <form action={createProduct}>
      <input name="name" required />
      <input name="price" type="number" required />
      <button type="submit">–°–æ–∑–¥–∞—Ç—å</button>
    </form>
  );
}
```

---

## üé® –°–¢–ò–õ–ò –ò TAILWIND

### –ü—Ä–∞–≤–∏–ª–∞ Tailwind

```tsx
// ‚úÖ –•–û–†–û–®–û ‚Äî —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Å—ã
<button className="bg-primary text-white hover:bg-primary-dark">
  –ö—É–ø–∏—Ç—å
</button>

// ‚ùå –ü–õ–û–•–û ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
<button className="bg-[#3B82F6] text-white">
  –ö—É–ø–∏—Ç—å
</button>

// ‚úÖ –•–û–†–û–®–û ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ spacing
<div className="p-4 mt-6 gap-2">

// ‚ùå –ü–õ–û–•–û ‚Äî –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ spacing
<div className="p-[13px] mt-[22px]">
```

### clsx –¥–ª—è —É—Å–ª–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤

```tsx
import { clsx } from 'clsx';

// ‚úÖ –ß–∏—Å—Ç—ã–µ —É—Å–ª–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã
<button
  className={clsx(
    'px-4 py-2 rounded font-medium transition',
    variant === 'primary' && 'bg-primary text-white',
    variant === 'secondary' && 'bg-gray-100 text-gray-900',
    disabled && 'opacity-50 cursor-not-allowed'
  )}
>
  {children}
</button>
```

### CVA –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```tsx
import { cva, type VariantProps } from 'class-variance-authority';

const buttonVariants = cva(
  // –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏
  'inline-flex items-center justify-center rounded-md font-medium transition-colors',
  {
    variants: {
      variant: {
        primary: 'bg-primary text-white hover:bg-primary/90',
        secondary: 'bg-secondary text-white hover:bg-secondary/90',
        outline: 'border-2 border-primary text-primary hover:bg-primary/10',
        ghost: 'hover:bg-gray-100',
      },
      size: {
        sm: 'h-8 px-3 text-sm',
        md: 'h-10 px-4',
        lg: 'h-12 px-6 text-lg',
      },
    },
    defaultVariants: {
      variant: 'primary',
      size: 'md',
    },
  }
);

interface ButtonProps 
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {}

export function Button({ variant, size, className, ...props }: ButtonProps) {
  return (
    <button 
      className={buttonVariants({ variant, size, className })} 
      {...props} 
    />
  );
}
```

---

## ü™ù –•–£–ö–ò

### –ü—Ä–∞–≤–∏–ª–∞ —Ö—É–∫–æ–≤

```tsx
// ‚úÖ –•—É–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
function Component() {
  const [state, setState] = useState(false);
  const data = useData();
  
  // ‚ùå –ù–ï–õ–¨–ó–Ø ‚Äî —Ö—É–∫ –≤–Ω—É—Ç—Ä–∏ —É—Å–ª–æ–≤–∏—è
  if (condition) {
    const value = useSomething(); // ‚ùå
  }
  
  return <div />;
}
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏

```tsx
// ‚úÖ –•—É–∫ –¥–ª—è fetch –¥–∞–Ω–Ω—ã—Ö
function useProducts(filters: ProductFilters) {
  const [state, setState] = useState<AsyncState<Product[]>>({
    status: 'idle',
  });
  
  useEffect(() => {
    let cancelled = false;
    
    async function fetchProducts() {
      setState({ status: 'loading' });
      
      try {
        const products = await api.getProducts(filters);
        if (!cancelled) {
          setState({ status: 'success', data: products });
        }
      } catch (error) {
        if (!cancelled) {
          setState({ status: 'error', error: error as Error });
        }
      }
    }
    
    fetchProducts();
    
    return () => {
      cancelled = true;
    };
  }, [filters]);
  
  return state;
}
```

### useCallback –∏ useMemo

```tsx
// ‚úÖ useCallback ‚Äî –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –≤ –ø—Ä–æ–ø—Å—ã
const handleClick = useCallback(() => {
  onItemClick(item.id);
}, [item.id, onItemClick]);

// ‚úÖ useMemo ‚Äî –¥–ª—è –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
const sortedItems = useMemo(() => {
  return [...items].sort((a, b) => a.price - b.price);
}, [items]);

// ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
const fullName = useMemo(() => `${first} ${last}`, [first, last]); // –∏–∑–±—ã—Ç–æ—á–Ω–æ
const fullName = `${first} ${last}`; // –ø—Ä–æ—Å—Ç–æ –≤—ã—á–∏—Å–ª–∏
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í

### Feature-based —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
features/
‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductCard.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductList.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductFilters.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProducts.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProductFilters.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ productService.ts
‚îÇ   ‚îú‚îÄ‚îÄ types.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts          # –ü—É–±–ª–∏—á–Ω—ã–π API —Ñ–∏—á–∏
```

### Barrel exports

```tsx
// features/products/index.ts
export { ProductCard } from './components/ProductCard';
export { ProductList } from './components/ProductList';
export { ProductFilters } from './components/ProductFilters';
export { useProducts } from './hooks/useProducts';
export type { Product, ProductFilters as ProductFiltersType } from './types';

// –ò–º–ø–æ—Ä—Ç
import { ProductCard, useProducts, Product } from '@/features/products';
```

---

## üö´ –ê–ù–¢–ò–ü–ê–¢–¢–ï–†–ù–´

### –ò–∑–±–µ–≥–∞–π prop drilling

```tsx
// ‚ùå –ü–õ–û–•–û ‚Äî –ø–µ—Ä–µ–¥–∞—ë–º user —á–µ—Ä–µ–∑ –≤—Å–µ —É—Ä–æ–≤–Ω–∏
function App() {
  const user = useUser();
  return <Layout user={user}><Page user={user}><Component user={user} /></Page></Layout>;
}

// ‚úÖ –•–û–†–û–®–û ‚Äî Context –∏–ª–∏ —Ö—É–∫
function Component() {
  const user = useUser(); // —Ö—É–∫ –ø–æ–ª—É—á–∞–µ—Ç –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
  return <div>{user.name}</div>;
}
```

### –ò–∑–±–µ–≥–∞–π inline objects –≤ –ø—Ä–æ–ø—Å–∞—Ö

```tsx
// ‚ùå –ü–õ–û–•–û ‚Äî –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä
<Component style={{ color: 'red' }} />
<Component config={{ theme: 'dark', size: 'lg' }} />

// ‚úÖ –•–û–†–û–®–û ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
const style = { color: 'red' };
const config = useMemo(() => ({ theme: 'dark', size: 'lg' }), []);

<Component style={style} />
<Component config={config} />
```

### –ò–∑–±–µ–≥–∞–π –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ —Ä–µ–Ω–¥–µ—Ä–µ

```tsx
// ‚ùå –ü–õ–û–•–û ‚Äî –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä
{items.map(item => (
  <Item key={item.id} onClick={() => handleClick(item.id)} />
))}

// ‚úÖ –•–û–†–û–®–û ‚Äî useCallback –∏–ª–∏ –≤—ã–Ω–µ—Å–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
const handleItemClick = useCallback((id: string) => {
  // ...
}, []);

{items.map(item => (
  <Item key={item.id} id={item.id} onClick={handleItemClick} />
))}

// –ò–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∞–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
function Item({ item, onClick }: ItemProps) {
  const handleClick = () => onClick(item.id);
  return <div onClick={handleClick}>{item.name}</div>;
}
```

---

## ‚ö° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø

### React.memo –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

```tsx
// ‚úÖ memo –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ø–∏—Å–∫–∞
export const ProductCard = memo(function ProductCard({ product }: Props) {
  return <div>{product.name}</div>;
});

// –í —Ä–æ–¥–∏—Ç–µ–ª–µ
{products.map(product => (
  <ProductCard key={product.id} product={product} />
))}
```

### Suspense –∏ Loading States

```tsx
// app/products/page.tsx
import { Suspense } from 'react';
import { ProductList } from '@/features/products';
import { ProductListSkeleton } from '@/features/products/components/ProductListSkeleton';

export default function ProductsPage() {
  return (
    <Suspense fallback={<ProductListSkeleton />}>
      <ProductList />
    </Suspense>
  );
}
```

### Dynamic Imports

```tsx
import dynamic from 'next/dynamic';

// –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç—è–∂—ë–ª—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
const Chart = dynamic(() => import('@/components/Chart'), {
  loading: () => <ChartSkeleton />,
  ssr: false, // –¢–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
});

const Modal = dynamic(() => import('@/components/Modal'));
```

---

## üìã CHECKLIST

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç

- [ ] –ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç
- [ ] Props —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ interface
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫: imports ‚Üí types ‚Üí component ‚Üí hooks ‚Üí handlers ‚Üí render
- [ ] 'use client' —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ
- [ ] memo –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–∞—Ö
- [ ] –ù–µ—Ç inline objects/functions –≤ –ø—Ä–æ–ø—Å–∞—Ö

### Next.js

- [ ] Server Components –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] Server Actions –¥–ª—è –º—É—Ç–∞—Ü–∏–π
- [ ] Suspense –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- [ ] Metadata –¥–ª—è SEO
- [ ] Image component –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-01-31
